<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>OneDrive Folder Picker</title>
    <script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        font-family: sans-serif;
        background-color: #f3f4f6;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #launch {
        width: 90vw; /* Ocupa 90% del ancho de la ventana */
        height: 80vh; /* Ocupa 80% de la altura de la ventana */
        font-size: 2.5rem;
        background-color: #0078d4;
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        transition: background-color 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        user-select: none;
      }
      #launch:hover {
        background-color: #005a9e;
      }
      #launch:active {
        background-color: #004080;
      }
    </style>
  </head>
  <body>
    <button id="launch">Seleccionar carpeta</button>

    <script type="text/javascript">
      document.getElementById("launch").addEventListener("click", function () {
        var odOptions = {
          clientId: "76c1d462-a573-4508-9b52-127da2119ef7",
          action: "query",
          multiSelect: false,
          viewType: "folders",
          openInNewWindow: false,
          advanced: {
            redirectUri: "https://onedrive-picker-demo.web.app",
            scope: "files.readwrite",
            folderSelect: true
          },
          success: function (folder) {
            if (window.flutter_inappwebview) {
              window.flutter_inappwebview.callHandler("onFolderSelected", folder);
            } else {
              alert("Flutter handler no disponible");
            }
          },
          cancel: function () {
            console.log("Selecci√≥n cancelada");
          },
          error: function (e) {
            console.error("Error en Picker:", e);
            if (window.flutter_inappwebview) {
              window.flutter_inappwebview.callHandler("onPickerError", e);
            }
          }
        };

        OneDrive.open(odOptions);
      });
    </script>
  </body>
</html>
